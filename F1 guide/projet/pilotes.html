<!doctype html>
<html lang="fr">
    <head>   <!-- D√©finition d'informations qui ne s'affichent pas sur la page -->
        <meta charset="utf-8" /> <!-- Conventions d'√©criture pour assurer un affichage correct des caract√®res sp√©ciaux -->
        <link rel="stylesheet" href="../style/style.css" /> <!-- Lien avec la feuille de style en CSS -->
        <title>F1 guide</title> <!-- Titre de l'onglet -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> <!-- Configuration du bootstrap -->

        <!-- Configuration du favicon avec une compatibilit√© maximale -->
        <link rel="apple-touch-icon" sizes="180x180" href="../images/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon/favicon-16x16.png">
        <link rel="manifest" href="../images/favicon/site.webmanifest">
    </head>
    <body> <!-- Corps de la page (contenu visible)-->

        <section class="hero-image"> <!-- Image d'accueil -->
                <a style="color : white; text-decoration: none; font-size: xx-large; font-weight: bold;" href="#header">Start</a>
        </section>

        <main>
            <header class="main-header" id="header">
                <nav>
                    <img src="../images/F1_logo_sans_fond.png" alt="F1 Logo" class="header-logo">
                    <ul>
                        <li><a href="travail_projet.html#header">Classements</a></li>
                        <li><a href="courses.html#header">Courses</a></li>
                        <li><a href="circuits.html#header">Circuits</a></li>
                        <li><a class="active" href="#header">Pilotes</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </nav>
            </header>

            <section id="pilotes">
                <select id="select-annee-pilote" name="annee-pilote"></select>
                <select id="select-pilote" name="pilote"></select>

                <div class="tab-container">
                    <div class="table-responsive">
                        <h2>Informations pilote</h2>
                        <table class="table table-dark table-striped table-hover table-rounded">
                            <caption>Informations pilote</caption>
                            <thead>
                                <tr>
                                    <th>Information</th>
                                    <th>D√©tail</th>
                                </tr>
                            </thead>
                            <tbody id="infos-pilote">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>

        <footer id="contact">
            <p>
                &copy; 2025 F1 Guide. Tous droits r√©serv√©s. <a href="../CV_Joaquim_DAUBAGNA--LEFEBVRE.pdf" target="_blank">Lien vers mon CV ‚Üí</a>
            </p>
        </footer>
    </body>






    
    <script>
        // --- Variables globales ---
        const anneeSelect = document.getElementById("select-annee-pilote"); 
        const piloteSelect = document.getElementById("select-pilote"); 
        const anneeCourante = new Date().getFullYear();
        let pilotesActuels = [];

        // --- 1. Cr√©er les options d'ann√©es (de 1950 √† maintenant) ---
        for (let annee = anneeCourante; annee >= 1950; annee--) {
            const option = document.createElement("option");
            option.value = annee;
            option.textContent = annee;
            anneeSelect.appendChild(option);
        }

        // --- 2. Fonction pour charger les pilotes d'une ann√©e ---
        function chargerPilotes(annee) {
            const url = `https://api.jolpi.ca/ergast/f1/${annee}/drivers`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    // Vide le select
                    piloteSelect.innerHTML = '';
                    
                    pilotesActuels = data.MRData.DriverTable.Drivers;
                    
                    // Trier les pilotes par nom de famille (ordre alphab√©tique)
                    pilotesActuels.sort((a, b) => {
                        return a.familyName.localeCompare(b.familyName);
                    });
                    
                    pilotesActuels.forEach((pilote, index) => {
                        const option = document.createElement("option");
                        option.value = pilote.driverId;
                        option.dataset.index = index;
                        option.textContent = `${pilote.givenName} ${pilote.familyName}`;
                        piloteSelect.appendChild(option);
                    });
                    
                    // S√©lectionner automatiquement le premier pilote et afficher ses informations
                    if (pilotesActuels.length > 0) {
                        piloteSelect.value = pilotesActuels[0].driverId;
                        afficherInfosPilote(pilotesActuels[0].driverId);
                    }
                })
                .catch(error => {
                    console.error('Erreur:', error);
                    piloteSelect.innerHTML = '<option value="">Erreur de chargement</option>';
                    afficherErreur('Impossible de charger les pilotes');
                });
        }

        // --- 3. Fonction pour afficher les informations d'un pilote ---
        function afficherInfosPilote(driverId) {
            const pilote = pilotesActuels.find(p => p.driverId === driverId);
            
            const tbody = document.getElementById('infos-pilote');
            tbody.innerHTML = '';
            
            // Tableau des informations √† afficher
            const infos = [
                { label: 'Pr√©nom', valeur: pilote.givenName },
                { label: 'Nom', valeur: pilote.familyName },
                { label: 'Num√©ro permanent', valeur: pilote.permanentNumber || 'N/A' },
                { label: 'Code', valeur: pilote.code || 'N/A' },
                { label: 'Date de naissance', valeur: pilote.dateOfBirth || 'N/A' },
                { label: 'Nationalit√©', valeur: pilote.nationality },
                { label: 'Wikip√©dia', valeur: `<a href="${pilote.url}" target="_blank" rel="noopener noreferrer" style="color: #e10600; text-decoration: none; font-weight: bold;">üìñ Voir la page ‚Üí</a>` }
            ];
            
            // Cr√©er une ligne pour chaque information
            infos.forEach(info => {
                const ligne = tbody.insertRow();
                
                // Colonne titre (cat√©gorie)
                const cellTitre = ligne.insertCell();
                cellTitre.textContent = info.label;
                cellTitre.style.fontWeight = 'bold';
                
                // Colonne valeur
                const cellValeur = ligne.insertCell();
                cellValeur.innerHTML = info.valeur;
            });
        }

        // --- 4. Fonction qui affiche un message en cas d'erreur ---
        function afficherErreur(message) {
            const tbody = document.getElementById('infos-pilote');
            tbody.innerHTML = `<tr><td colspan="2" class="no-data" style="color: #e10600;">${message}</td></tr>`;
        }

        // --- 5. √âcouteurs d'√©v√©nements ---
        anneeSelect.addEventListener('change', function() {
                chargerPilotes(this.value);
        });

        piloteSelect.addEventListener('change', function() {
                afficherInfosPilote(this.value);
        });

        // --- 6. Initialisation ---
        // Charger automatiquement l'ann√©e en cours au d√©marrage
        window.addEventListener('load', function() {
            anneeSelect.value = anneeCourante;
            chargerPilotes(anneeCourante);
        });
    </script>
</html>